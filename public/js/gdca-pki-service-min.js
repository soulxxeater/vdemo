var WUStatus={idle:0,opening:1,opened:2,closed:3};var WUEvent={connect:0,closed:1,ukey_event:2};var WUProtocol={unknow:0,xdr:1,xhr:2,ws:3};var WSMessage={ukey_event:1};var gJSVersion="2.1";var gMaxTryPortNum=5;function WebUtility(){var u=null;var d=[];var w;var b=null;var C=[];var G=[];var H=[];var t=[];var e=0;var o=0;var g=0;var z=0;var j={host:"127.0.0.1",port:0,proto:"http://"};var v={host:"127.0.0.1",port:0,proto:"ws://"};var f=false;var D=0;var m=WUStatus.idle;var l=WUStatus.idle;var F=WUStatus.idle;var s=null;var r=[];var I;var n;var c=false;var x=false;var h="";var y="";var a=null;var B=this;var q=false;var p="/gdca_ws_v2";var k=null;var A=500;var J="127.0.0.1";this.setWSHandshakeTimeOut=function(K){A=K};this.setHttpTryPorts=function(K){C=K};this.setHttpsTryPorts=function(K){G=K};this.setWSTryPorts=function(K){H=K};this.setWSSTryPorts=function(K){t=K};this.setIPAddr=function(K){J=K};this.base64Encode=function(L){var K=CryptoJS.enc.Utf8.parse(L);return CryptoJS.enc.Base64.stringify(K).toString()};this.base64Decode=function(M){try{var L=CryptoJS.enc.Base64.parse(M);return CryptoJS.enc.Utf8.stringify(L)}catch(K){return""}};var E=function(K){var L=false;for(i=0;i<d.length;i++){if(d[i]==K){K.onload=null;K.onerror=null;K.ontimeout=null;K.onprogress=null;L=true;break}}if(L){d.splice(i,1)}};this.checkRequestQueue=function(){if(r.length>0){var K=r.shift();this.Request(K.data,K.callback)}};this.initWebSocket=function(){m=WUStatus.opening;if(typeof WebSocket!="undefined"){w=new WebSocket(y,"lws-gdca")}else{if(typeof MozWebSocket!="undefined"){w=new MozWebSocket(y,"lws-gdca")}}if(w!=null){w.onerror=function(K){if(m==WUStatus.opened){var L={ErrorCode:SOR_ServiceErr,ErrorMsg:"ws通讯错误",Status:0};s(L);s=null}};w.onclose=function(){w=null;if(m==WUStatus.opened){m=WUStatus.idle;a(WUEvent.closed)}else{m=WUStatus.closed}};w.onopen=function(){m=WUStatus.opened;c=true;a(WUEvent.connect,true,WUProtocol.ws)};w.onmessage=function(L){var K=JSON.parse(L.data);if(K.code!=undefined){K.ErrorCode=K.code}else{K.ErrorCode=parseInt(K.ErrorCode,16)}if(s!=null){var M=s;s=null;M(K);window.setTimeout(B.checkRequestQueue(),0)}else{if(k!=null){k(K)}}}}else{m=WUStatus.idle}};this.initXMLHttpRequest=function(){l=WUStatus.opening;if(window.XMLHttpRequest){u=new XMLHttpRequest()}else{if(D<8){u=new ActiveXObject("Microsoft.XMLHTTP")}else{l=WUStatus.closed;if(a!=null){a(WUEvent.connect,false,WUProtocol.xhr)}return false}}if(!q){u.onerror=function(){if(s!=null){var K={ErrorCode:SOR_XHRErr,ErrorMsg:"XHR通讯出错",Status:0};s(K);s=null}};u.ontimeout=function(){var K={ErrorCode:SOR_ServiceTimeoutErr,ErrorMsg:"XHR通讯超时",Status:0};s(K);s=null};u.onreadystatechange=function(){if(u.readyState==4){if(u.status==200){var K=JSON.parse(u.responseText);K.ErrorCode=parseInt(K.ErrorCode,16);s(K);s=null;window.setTimeout(B.checkRequestQueue(),0)}else{var L={ErrorCode:SOR_XHROnReadyErr,ErrorMsg:"XHR通讯失败",Status:0};s(L);s=null}}}}l=WUStatus.opened;if(a!=null){a(WUEvent.connect,true,WUProtocol.xhr)}return true};this.initXDomainRequest=function(){F=WUStatus.opening;if(b!=null){b=null}b=new XDomainRequest();b.ontimeout=function(){E(b);var K={ErrorCode:SOR_ServiceTimeoutErr,ErrorMsg:"xdr操作超时",Status:0};s(K);s=null};b.onload=function(){E(b);var N=s;try{var K=JSON.parse(b.responseText);K.ErrorCode=parseInt(K.ErrorCode,16);s=null;N(K)}catch(M){var L={ErrorCode:SOR_ServiceErr,ErrorMsg:"xdr接收异常:"+M.message,Status:0};N(L);s=null}};b.onerror=function(){E(b);var K={ErrorCode:SOR_ServiceErr,ErrorMsg:"xdr操作错误",Status:0};s(K);s=null};b.onprogress=function(){};F=WUStatus.opened;return true};this.timerCheckWSOpenBody=function(K){if(m==WUStatus.opened){clearInterval(I)}else{if(m==WUStatus.closed){z++;g++;if(x&&z<t.length){v.port=t[z];y=v.proto+v.host+":"+v.port.toString()+p;this.initWebSocket();return}else{if(g<H.length){v.port=H[g];y=v.proto+v.host+":"+v.port.toString()+p;this.initWebSocket();return}}clearInterval(I);if(C.length==0){c=true;a(WUEvent.connect,false,WUProtocol.unknow);return}if(D==8||D==9){var L=this.initXDomainRequest();a(WUEvent.connect,true,WUProtocol.xdr);c=true}else{var L=this.initXMLHttpRequest();c=true}}else{w.close()}}};this.timerCheckWSOpen=function(K){return function(){K.timerCheckWSOpenBody(K)}};this.init=function(K,M,L){if(K==PROTO_AUTO){x=location.href.indexOf("https")!=-1}else{if(K==PROTO_SSL){x=true}}if(M!=null){a=M}else{q=true}k=L;f=isIE();if(f){D=getIEVersion()}this.updateURL();if((D==11&&x)||q||(isFirefox()&&x)){return this.initXMLHttpRequest()}if(w==null){this.initWebSocket()}if(u==null){if(m==WUStatus.opening){I=window.setInterval(this.timerCheckWSOpen(this),A)}else{if(m==WUStatus.idle){if(D==8||D==9){this.initXDomainRequest();a(WUEvent.connect,true,WUProtocol.xdr);c=true}else{c=this.initXMLHttpRequest()}}}}return c};this.updateURL=function(){if(x){j.proto="https://";j.host="localhost";if(G.length>0){j.port=G[e]}v.proto="wss://";if(f){v.host=J}else{v.host="localhost"}v.port=t[z]}else{j.proto="http://";j.host=J;if(C.length>0){j.port=C[e]}v.proto="ws://";v.host=J;v.port=H[z]}if(j.port>0){h=j.proto+j.host+":"+j.port.toString()}y=v.proto+v.host+":"+v.port.toString()+p;return true};this.wsSend=function(K){if(m==WUStatus.opened){w.send(K);return true}else{return false}};this.xhrSend=function(M,L){if(l==WUStatus.opened){try{u.open("POST",h,!L);u.setRequestHeader("Content-type","application/x-www-form-urlencoded");u.send(M)}catch(N){var K={ErrorCode:SOR_XHRExceptionErr,ErrorMsg:"XHR通讯异常",name:N.name,code:N.code};if(L){return K}else{if(s!=null){s(K)}}}if(L){if(u.readyState==4&&u.status==200){var K=JSON.parse(u.responseText);K.ErrorCode=parseInt(K.ErrorCode,16);return K}else{var K={ErrorCode:SOR_XHRSendErr,ErrorMsg:"XHR通讯失败"};return K}}else{return true}}if(L){var K={ErrorCode:SOR_XHRNotInitErr,ErrorMsg:"未初始化"};return K}return false};this.xdrSend=function(K){this.initXDomainRequest();b.open("POST",h);b.send(K);d.push(b);return true};this.Request=function(L,O){if(O==undefined){return this.xhrSend(L,true)}if(s!=null){var K={data:L,callback:O};r.push(K);return true}s=O;try{if(this.wsSend(L)){return true}if(D==8||D==9){if(this.xdrSend(L)){return true}}if(this.xhrSend(L,false)){return true}var N={ErrorCode:SOR_ServiceNotConnect,ErrorMsg:"未连接服务",Status:0};if(O!=undefined){O(N)}return false}catch(M){var N={ErrorCode:SOR_ServiceErr,ErrorMsg:"通讯异常:"+M.message,Status:0};if(O!=undefined){O(N)}else{return N}}}}function GdcaPKIService(){var c=null;var a=null;var b=5;this.setWSHandshakeTimeOut=function(d){c.setWSHandshakeTimeOut(d)};this.setMaxTryPortNum=function(d){b=d};this.genPorts=function(f,e){var d=f;for(i=1;i<=b;i++){e.push(d);if(i%5==0){d-=5000}else{d-=7}}};this.Initialize=function(f,k){if(k!=undefined){a=k}if(c==null){var j=[];var e=[];var h=[];var g=[];c=new WebUtility();this.genPorts(55661,j);this.genPorts(55662,e);this.genPorts(55663,h);this.genPorts(55664,g);c.setHttpTryPorts(j);c.setHttpsTryPorts(e);c.setWSTryPorts(h);c.setWSSTryPorts(g)}else{if(k!=undefined){k(WUEvent.connect,true,0);return SOR_OK}}if(c.init(f,k!=undefined?this.initCallback:null,this.onSvcMessage)){if(k==undefined){var d=c.Request('{"funcid":0}');return d.ErrorCode}return SOR_OK}return SOR_OK};this.init=this.Initialize;this.onSvcMessage=function(d){switch(d.msg){case WSMessage.ukey_event:a(WUEvent.ukey_event,d.data,0);break;default:break}},this.initCallback=function(f,d,e){if(e==WUProtocol.xhr||e==WUProtocol.xdr){c.Request('{"funcid":0}',function(g){a(WUEvent.connect,g.ErrorCode==SOR_OK,g.ErrorCode)})}else{a(f,d,0)}},this.base64Encode=function(e){var d=CryptoJS.enc.Utf8.parse(e);return CryptoJS.enc.Base64.stringify(d).toString()};this.base64Decode=function(g){try{var f=CryptoJS.enc.Base64.parse(g);return CryptoJS.enc.Utf8.stringify(f)}catch(d){return""}};this.GetVersion=function(e){var d={Result:gJSVersion,ErrorCode:SOR_OK};if(e==undefined){return d}e(d)};this.SOF_GetVersion=function(e){var d={funcid:0};return c.Request(JSON.stringify(d),e)};this.SOF_SetSignMethod=function(e,f){var d={funcid:1,SignMethod:e};return c.Request(JSON.stringify(d),f)};this.SOF_GetSignMethod=function(e){var d={funcid:2};return c.Request(JSON.stringify(d),e)};this.SOF_Ext_GetProductVersion=function(e,f){var d={funcid:49,productType:e};return c.Request(JSON.stringify(d),f)};this.SOF_Config=function(g,e,f){var d={funcid:43,setType:g,setVal:e};return c.Request(JSON.stringify(d),f)};this.SOF_Ext_EnumDevice=function(e){var d={funcid:37};return c.Request(JSON.stringify(d),e)};this.SOF_Ext_GetDeviceType=function(e){var d={funcid:42};return c.Request(JSON.stringify(d),e)};this.SOF_GetUserList=function(e){var d={funcid:5,ReturnMethod:0};return c.Request(JSON.stringify(d),e)};this.SOF_GetDeviceInfo=function(e,d,g){var f={funcid:13,ContainerName:e,Type:d};return c.Request(JSON.stringify(f),g)};this.SOF_Login=function(d,f,h){if(f==undefined||f==null){var e={ErrorCode:SOR_NULLPointerErr,ErrorMsg:"参数PIN无效",Status:0};if(h!=undefined){h(e);return}else{return e}}var g={funcid:7,UserName:d,PassWd:c.base64Encode(f)};return c.Request(JSON.stringify(g),h)};this.SOF_Ext_isLogin=function(d,f,g){var e={funcid:45,containerName:d,loginType:f};return c.Request(JSON.stringify(e),g)};this.SOF_GetPinRetryCount=function(d,f){var e={funcid:8,ContainerName:d};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_Logout=function(d,f,g){var e={funcid:46,containerName:d,loginType:f};return c.Request(JSON.stringify(e),g)};this.SOF_ChangePassWd=function(d,f,g,j){if(f==undefined||f==null){var e={ErrorCode:SOR_NULLPointerErr,ErrorMsg:"参数PIN无效",Status:0};if(j!=undefined){j(e);return}else{return e}}var h={funcid:9,ContainerName:d,OldPassWd:c.base64Encode(f),NewPassWd:c.base64Encode(g)};return c.Request(JSON.stringify(h),j)};this.SOF_ExportUserCert=function(d,f){var e={funcid:6,ContainerName:d};return c.Request(JSON.stringify(e),f)};this.SOF_ExportExChangeUserCert=function(d,f){var e={funcid:10,ContainerName:d};return c.Request(JSON.stringify(e),f)};this.SOF_GetCertInfo=function(d,e,g){var f={funcid:11,Cert:d,Type:e};return c.Request(JSON.stringify(f),g)};this.SOF_GetCertInfoByOid=function(f,d,g){var e={funcid:12,Cert:f,Oid:d};return c.Request(JSON.stringify(e),g)};this.SOF_ValidateCert=function(e,f){var d={funcid:14,Cert:e};return c.Request(JSON.stringify(d),f)};this.SOF_SignData=function(d,g,f){var e={funcid:15,ContainerName:d,InData:g};return c.Request(JSON.stringify(e),f)};this.SOF_VerifySignedData=function(d,h,f,g){var e={funcid:16,EncodeCert:d,InData:h,SignValue:f};return c.Request(JSON.stringify(e),g)};this.SOF_SignFile=function(d,f,g){var e={funcid:17,ContainerName:d,SInFilePath:f};return c.Request(JSON.stringify(e),g)};this.SOF_VerifySignedFile=function(f,e,h,g){var d={funcid:18,EncodeCert:f,InData:e,SignValue:h};return c.Request(JSON.stringify(d),g)};this.SOF_SignMessage=function(e,d,h,g){var f={funcid:23,Flag:e,ContainerName:d,InData:h};return c.Request(JSON.stringify(f),g)};this.SOF_VerifySignedMessage=function(e,d,g){var f={funcid:24,MessageData:e,InData:d};return c.Request(JSON.stringify(f),g)};this.SOF_GetInfoFromSignedMessage=function(g,d,f){var e={funcid:25,MessageData:g,Type:d};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_PKCS7_SignFile=function(d,g,e,h){var f={funcid:47,ContainerName:d,SInFilePath:g,SignFileFlag:e};return c.Request(JSON.stringify(f),h)};this.SOF_Ext_PKCS7_VerifySignedFile=function(e,d,f,h){var g={funcid:48,MessageData:e,SInFilePath:d,SignFileFlag:f};return c.Request(JSON.stringify(g),h)};this.SOF_Ext_SetEnvelopType=function(e,f){var d={funcid:39,envType:e};return c.Request(JSON.stringify(d),f)};this.SOF_EncryptData=function(e,g,f){var d={funcid:19,EncodeCert:e,InData:g};return c.Request(JSON.stringify(d),f)};this.SOF_DecryptData=function(d,g,f){var e={funcid:20,ContainerName:d,InData:g};return c.Request(JSON.stringify(e),f)};this.SOF_EncryptFile=function(d,g,e,h){var f={funcid:21,EncodeCert:d,InFilePath:g,OutFilePath:e};return c.Request(JSON.stringify(f),h)};this.SOF_DecryptFile=function(d,g,e,h){var f={funcid:22,ContainerName:d,InFilePath:g,OutFilePath:e};return c.Request(JSON.stringify(f),h)};this.SOF_GenRandom=function(e,f){var d={funcid:26,Len:e};return c.Request(JSON.stringify(d),f)};this.SOF_Ext_ReadLabel=function(d,f,g,h){var e={funcid:44,containerName:d,lableName:f,lableType:g};return c.Request(JSON.stringify(e),h)};this.SOF_Ext_WriteUsrDataFile=function(e,h,d,j,f,k,l){var g={funcid:29,ContainerName:e,Pin:h,FileType:d,FileIndex:j,Offset:f,WriteData:k};return c.Request(JSON.stringify(g),l)};this.SOF_Ext_ReadUsrDataFile=function(e,d,h,j,g,k){var f={funcid:28,ContainerName:e,FileType:d,FileIndex:h,Offset:j,ReadLen:g};return c.Request(JSON.stringify(f),k)};this.SOF_Ext_HashFile=function(d,h,e,f,j){var g={funcid:27,AlgorithmType:d,InFile:h,PublicKey:e,ID:f};return c.Request(JSON.stringify(g),j)};this.SOF_SignDataXML=function(d,g,f){var e={funcid:30,ContainerName:d,InData:g};return c.Request(JSON.stringify(e),f)};this.SOF_VerifySignedDataXML=function(d,f){var e={funcid:31,SignedData:d};return c.Request(JSON.stringify(e),f)};this.SOF_GetXMLSignatureInfo=function(e,d,g){var f={funcid:32,SignedData:e,Type:d};return c.Request(JSON.stringify(f),g)};this.SOF_Ext_TspGetTime=function(e){var d={funcid:33};return c.Request(JSON.stringify(d),e)};this.SOF_Ext_TspGetStamp=function(g,d,f){var e={funcid:34,InData:g,AlgType:d};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_TspVerifyStamp=function(h,f,d,g){var e={funcid:35,InData:h,SealData:f,Cert:d};return c.Request(JSON.stringify(e),g)};this.SOF_Ext_Control=function(d,e,h,g){var f={funcid:36,ContainerName:d,CtrlName:e,CtrlCmd:h};return c.Request(JSON.stringify(f),g)};this.SOF_Ext_SymmEncrypt=function(e,h,f,d,j){var g={funcid:80,symmAlg:e,symmKey:h,iv:f,inData:d};return c.Request(JSON.stringify(g),j)};this.SOF_Ext_SymmDecrypt=function(e,h,f,d,j){var g={funcid:81,symmAlg:e,symmKey:h,iv:f,inData:d};return c.Request(JSON.stringify(g),j)};this.SOF_Ext_ParseCertInfo=function(f,d,e,h){var g={funcid:82,cert:f,flags:d,oids:e};return c.Request(JSON.stringify(g),h)};this.SOF_Ext_SymmEncryptFile=function(d,h,j,e,g,k){var f={funcid:40,symmAlg:d,symmKey:h,symmIV:j,inFilePath:e,outFilePath:g};return c.Request(JSON.stringify(f),k)};this.SOF_Ext_SymmDecryptFile=function(d,h,j,e,g,k){var f={funcid:41,symmAlg:d,symmKey:h,symmIV:j,inFilePath:e,outFilePath:g};return c.Request(JSON.stringify(f),k)};this.SOF_Ext_Base64Encode=function(f,e){var d={funcid:50,InData:f};return c.Request(JSON.stringify(d),e)};this.SOF_Ext_EnumFile=function(d,f){var e={funcid:51,ContainerName:d};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_CreateFile=function(e,k,h,d,f,j){var g={funcid:52,ContainerName:e,fileName:k,fileLen:h,readRights:d,writeRights:f};return c.Request(JSON.stringify(g),j)};this.SOF_Ext_DeleteFile=function(d,g,f){var e={funcid:53,ContainerName:d,fileName:g};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_GetFileAttribute=function(d,g,f){var e={funcid:56,ContainerName:d,fileName:g};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_ReadFile=function(d,j,g,f,h){var e={funcid:54,ContainerName:d,fileName:j,offset:g,readLen:f};return c.Request(JSON.stringify(e),h)};this.SOF_Ext_WriteFile=function(d,k,h,g,e,j){var f={funcid:55,ContainerName:d,fileName:k,offset:h,dataFmt:g,fileData:e};return c.Request(JSON.stringify(f),j)};this.SOF_Ext_HashData=function(e,d,g,f,h,k){var j={funcid:57,hashAlg:e,inData:d,inDataFmt:g,pubKey:f,uid:h};return c.Request(JSON.stringify(j),k)};this.SOF_Ext_ExportPublicKey=function(d,f,g){var e={funcid:59,container:d,keyUsage:f};return c.Request(JSON.stringify(e),g)};this.SOF_Ext_AsymmEncryptData=function(d,e,g){var f={funcid:60,inData:d,pubKey:e};return c.Request(JSON.stringify(f),g)};this.SOF_Ext_AsymmDecryptData=function(d,f,g){var e={funcid:61,container:d,encData:f};return c.Request(JSON.stringify(e),g)};this.SOF_Ext_EnumSeal=function(d,f){var e={funcid:62,container:d};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_GetSeaInfo=function(d,g,e,h){var f={funcid:63,container:d,sealIdx:g,infoType:e};return c.Request(JSON.stringify(f),h)};this.SOF_Ext_GetSealInfoEPoint=function(d,f){var e={funcid:88,container:d};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_SignHash=function(e,d,f,h){var g={funcid:83,container:e,hashAlg:d,hashedData:f};return c.Request(JSON.stringify(g),h)};this.SOF_Ext_SignMultiHash=function(e,d,f,h){var g={funcid:89,container:e,hashAlg:d,hashData:f};return c.Request(JSON.stringify(g),h)};this.SOF_Ext_VerifySignedHash=function(d,f,e,h){var g={funcid:87,signCert:d,hashedData:f,signature:e};return c.Request(JSON.stringify(g),h)};this.SOF_Ext_GenCSR=function(e,d,g){var f={funcid:84,container:e,dn:d};return c.Request(JSON.stringify(f),g)};this.SOF_Ext_ParseCSR=function(d,f){var e={funcid:85,csr:d};return c.Request(JSON.stringify(e),f)};this.CommonCommand=function(e,f,g){var d={funcid:101,cmd:e,params:f};return c.Request(JSON.stringify(d),g)};this.SOF_Finalize=function(e){var d={funcid:38};return c.Request(JSON.stringify(d),e)};this.SOF_Ext_LockDevice=function(d,f){var e={funcid:77,container:d};return c.Request(JSON.stringify(e),f)};this.SOF_Ext_LockDeviceEx=function(d,e,g){var f={funcid:77,container:d,timeOut:e};return c.Request(JSON.stringify(f),g)};this.SOF_Ext_UnLockDevice=function(d,f){var e={funcid:78,container:d};return c.Request(JSON.stringify(e),f)};this.ConvertCertValicateErrCode=function(e){var d=SOR_CertValicateErr;switch(e){case SOF_CERT_NOT_TRUSTED:d=SOR_CERTINVALIDErr;break;case SOF_CERT_HASEXPIRED:d=SOR_CERTHASEXPIREDErr;break;case SOF_CERT_REVOKED:d=SOR_CERTREVOKEDErr;break;case SOF_CERT_FROZEN:d=SOR_CertFrozenErr;break;case SOF_CERT_NOTYETVALID:d=SOR_CertNotYetValidErr;break;default:d=e;break}return d};this.SOF_GetErrMsg=function(d){var e="";switch(d){case SOR_OK:e="成功";break;case SOR_UnknownErr:e="异常错误";break;case SOR_NotSupportYetErr:e="不支持的功能";break;case SOR_FileErr:e="文件操作错误";break;case SOR_ProviderTypeErr:e="服务提供者参数类型错误";break;case SOR_LoadProviderErr:e="导入服务提供者接口错误";break;case SOR_LoadDevMngApiErr:e="导入设备管理接口错误";break;case SOR_AlgoTypeErr:e="算法类型错误";break;case SOR_NameLenErr:e="名称长度错误";break;case SOR_KeyUsageErr:e="密钥用途错误";break;case SOR_ModulusLenErr:e="模的长度错误";break;case SOR_NotInitializeErr:e="未初始化";break;case SOR_ObjErr:e="对象错误";break;case SOR_MemoryErr:e="内存错误";break;case SOR_TimeoutErr:e="服务超时";break;case SOR_IndataLenErr:e="输入数据长度错误";break;case SOR_IndataErr:e="输入数据错误";break;case SOR_GenRandErr:e="生成随机数错误";break;case SOR_HashObjErr:e="HASH对象错";break;case SOR_HashErr:e="HASH运算错误";break;case SOR_GenRsaKeyErr:e="产生RSA密钥错";break;case SOR_RsaModulusLenErr:e="RSA密钥模长错误";break;case SOR_CspImprtPubKeyErr:e="CSP服务导入公钥错误";break;case SOR_RsaEncErr:e="RSA加密错误";break;case SOR_RsaDecErr:e="RSA解密错误";break;case SOR_HashNotEqualErr:e="HASH值不相等";break;case SOR_KeyNotFountErr:e="密钥未发现";break;case SOR_CertNotFountErr:e="证书未发现";break;case SOR_NotExportErr:e="对象未导出";break;case SOR_VeryPolicyErr:e="未能完全按照策略验证成功宏描述预定义值说明";break;case SOR_DecryptPadErr:e="解密时做补丁错误";break;case SOR_MacLenErr:e="MAC长度错误";break;case SOR_KeyInfoTypeErr:e="密钥类型错误";break;case SOR_NULLPointerErr:e="某一个参数为空指针";break;case SOR_APPNotFoundErr:e="没有找到该应用";break;case SOR_CERTENCODEErr:e="证书编码格式错误";break;case SOR_CERTINVALIDErr:e="证书无效,不是可信CA颁发的证书";break;case SOR_CERTHASEXPIREDErr:e="证书已过期";break;case SOR_CERTREVOKEDErr:e="证书已经被吊销";break;case SOR_SIGNDATAErr:e="签名失败";break;case SOR_VERIFYSIGNDATAErr:e="验证签名失败";break;case SOR_READFILEErr:e="读文件异常";break;case SOR_WRITEFILEErr:e="写文件异常";break;case SOR_SECRETSEGMENTErr:e="门限算法密钥分割失败";break;case SOR_SECERTRECOVERYErr:e="门限恢复失败";break;case SOR_ENCRYPTDATAErr:e="对数据的对称加密失败";break;case SOR_DECRYPTDATAErr:e="对称算法的数据解密失败";break;case SOR_PKCS7ENCODEErr:e="PKCS7编码格式错误";break;case SOR_XMLENCODEErr:e="不是合法的xml编码数据";break;case SOR_PARAMETERNOTSUPPORTErr:e="不支持的参数";break;case SOR_CTLNOTFOUND:e="没有发现信任列表";break;case SOR_APPNOTFOUND:e="设置的应用名称没发现";break;case SOR_ECCEncErr:e="ECC加密错误";break;case SOR_P7SignErr:e="P7签名错误";break;case SOR_P7DecErr:e="P7解密错误";break;case SOR_TSP_DataErr:e="时间戳服务器应答数据错误";break;case SOR_TSP_Err:e="时间戳服务器错误";break;case SOR_FileExistErr:e="文件已存在";break;case SOR_NotEnoughSpace:e="空间不足";break;case SOR_FileNotExistErr:e="文件不存在";break;case SOR_ReachMaxFileNum:e="已达到最大可创建文件数";break;case SOR_MUSpaceNotAllocErr:e="多用户空间未分配";break;case SOR_EnumDevErr:e="设备枚举错误";break;case SOR_CertNotYetValidErr:e="证书未生效";break;case SOR_CertFrozenErr:e="证书被冻结";break;case SOR_CAAuthErr:e="CA认证失败";break;case SOR_NotLoginErr:e="用户未登录";break;case SOR_KeyPairNotMatchErr:e="公私钥不匹配";break;case SOR_MUNotLogin:e="多用户未登录";break;case SOR_UserPinLocked:e="用户Pin被锁";break;case SOR_WrongPinErr:e="错误的口令";break;case SOR_ContainerNotExistErr:e="容器不存在";break;case SOR_CertParseErr:e="证书解析错误";break;case SOR_OIDInfoNotExist:e="OID信息项不存在";break;case SAR_MsgParseErr:e="报文解析错误";break;case SAR_MsgParamErr:e="报文参数错误";break;case SAR_MsgBase64Err:e="Base64编解码失败";break;case SOR_UserCancel:e="用户取消操作";break;case SOR_DeviceRemoved:e="设备已移除";break;case SOR_KeyNotMatchErr:e="密钥不匹配";break;case SOR_LableNotExist:e="标签不存在";break;case SOR_ServiceErr:e="服务错误";break;case SOR_ServiceTimeoutErr:e="通讯超时";break;case SOR_ServiceComErr:e="通讯错误";break;case SOR_ServiceNotConnect:e="未连接服务";break;case SOR_TSPEncodeErr:e="时间戳响应编码失败";break;case SOR_TSPDecodeErr:e="时间戳响应解码失败";break;case SOR_TSPNotExist:e="时间戳响应不存在";break;case SOR_Base64EncodeErr:e="base64编码错误";break;case SOR_Base64DecodeErr:e="base64解码错误";break;case SOR_SM2EncErr:e="SM2加密错误";break;case SOR_HttpReqeustErr:e="HTTP请求出错";break;case SOR_JsonParseErr:e="JSON解析错误";break;case SOR_FaceMatchFail:e="人脸匹配失败";break;case SOR_ServerErr:e="服务器错误";break;case SOR_SealNotExist:e="印章不存在";break;case SOR_HttpReqeustTimeOutErr:e="HTTP请求超时";break;case SOR_SealParseErr:e="印章解析失败";break;case SOR_FileOpenErr:e="文件打开失败";break;case SOR_DataDestroyed:e="数据被破坏";break;case SOR_DNItemNotExist:e="DN项信息不存在";break;case SOR_CACertNotExist:e="CA证书不存在";break;case SOR_CertNotTrustedErr:e="证书不被信任";break;case SOR_XHROpenErr:e="XHR打开失败";break;case SOR_XHRNotInitErr:e="XHR未初始化";break;case SOR_XHROnReadyErr:e="XHR接收数据失败";break;case SOR_XHRSendErr:e="XHR发送数据失败";break;case SOR_XHRExceptionErr:e="XHR通讯异常";break;case SOR_EnumNoCertErr:e="未检测到证书";break;default:e="未知错误";break}return e}}var gPKISvc=new GdcaPKIService();